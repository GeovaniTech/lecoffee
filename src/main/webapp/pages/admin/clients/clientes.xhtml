<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 
	lang="#{MBAppConfigs.appConfigs.language}"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:components="http://java.sun.com/jsf/composite/components">
	
	<h:body>
		<ui:composition template="/templates/admin/layout.xhtml">
			<ui:define name="name_page">
				<h:outputText value="#{label.customers}" />
			</ui:define>
			
			<ui:define name="body">
				<h:outputStylesheet library="css" name="/customers/customers.css" />
				
				<p:remoteCommand 
					name="updateTableClient"
					update=":formTableClient"/>
				
				<p:remoteCommand 
					name="openDialogChange"
					update="dialog-change-client"
					oncomplete="PF('dialog-change-client').show()" />
		
				<div class="top-buttons mg-b-10">
					<h:form class="form-top-buttons">
						<p:commandButton 
							oncomplete="PF('dialog-new-client').show()"
							icon="pi pi-plus" 
							styleClass="optionsButtonStyle" />
					</h:form>
				</div>
				
				<h:form id="formTableClient">
					<p:dataTable
						widgetVar="tableCustomers"
						var="client"
						value="#{MBClient.customers}"
						selectionMode="single"
						selection="#{MBClient.client}"
						rowKey="#{client.id}"
						scrollable="true"
						styleClass="#{MBClient.toggleFilter == false ? 'hide-filters' : ''}">
						
						<p:ajax 		
					 		event="rowSelect" 
					 		listener="#{MBClient.updateEmail()}"
					 		oncomplete="openDialogChange()" />
						
						<p:column styleClass="toggleFilter">
							<f:facet name="header">
								<p:commandLink
									action="#{MBClient.changeToggleFilter()}"
									oncomplete="updateTableClient();">
									
									<i class="pi pi-filter"></i>
								</p:commandLink>
							</f:facet>
						</p:column>
						
						<p:column 
							headerText="#{label.name}"
							filterBy="#{client.nome}">
							
							<f:facet name="filter">
								<p:inputText>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableCustomers').filter()" />
								</p:inputText>
							</f:facet>
							<h:outputText value="#{client.nome == null ? label.not_registered : client.nome}" />
						</p:column>
						
						<p:column 
							headerText="#{label.email}"
							filterBy="#{client.email}">
							
							<f:facet name="filter">
								<p:inputText>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableCustomers').filter()" />
								</p:inputText>
							</f:facet>
							
							<h:outputText value="#{client.email}" />
						</p:column>
						
						<p:column 
							headerText="#{label.total_orders}"
							filterBy="#{client.totalOrders}">
							
							<f:facet name="filter">
								<p:inputNumber>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableCustomers').filter()" />
								</p:inputNumber>
							</f:facet>
							<h:outputText value="#{client.totalOrders}" />
						</p:column>
						
						<p:column 
							headerText="#{label.completed_registration}"
							filterBy="#{client.completedRegistration}">
							
							<f:facet name="filter">
								<p:selectOneMenu style="width: 200px;">
									<f:selectItem 
										itemLabel="#{label.all}"
										itemValue="#{null}" />
							
									<f:selectItem 
										itemLabel="#{label.finished}"
										itemValue="#{true}" />
										
									<f:selectItem 
										itemLabel="#{label.not_finished}"
										itemValue="#{false}" />		
									
									<p:ajax 
										event="valueChange" 
										oncomplete="PF('tableCustomers').filter()" />
								</p:selectOneMenu>
							</f:facet>
							<h:outputText value="#{client.completedRegistration == true ? label.finished :  label.not_finished}" />
						</p:column>
						
						<p:column 
							headerText="#{label.blocked}"
							filterBy="#{client.blocked}">
							
							<f:facet name="filter">
								<p:selectOneMenu style="width: 200px;">
									<f:selectItem 
										itemLabel="#{label.all}"
										itemValue="#{null}" />
							
									<f:selectItem 
										itemLabel="#{label.yes}"
										itemValue="#{true}" />
										
									<f:selectItem 
										itemLabel="#{label.no}"
										itemValue="#{false}" />		
									
									<p:ajax 
										event="valueChange" 
										oncomplete="PF('tableCustomers').filter()" />
								</p:selectOneMenu>
							</f:facet>
							<h:outputText value="#{client.blocked == true ? label.yes : label.no}" />
						</p:column>
						
						<p:column 
							headerText="#{label.cep}"
							filterBy="#{client.cep}">
							
							<f:facet name="filter">
								<p:inputNumber>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableProducts').filter()" />
								</p:inputNumber>
							</f:facet>
							<h:outputText value="#{client.cep == null ? label.not_registered : client.cep}" />
						</p:column>
						
						<p:column 
							headerText="#{label.street}"
							filterBy="#{client.street}">
							
							<f:facet name="filter">
								<p:inputText>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableProducts').filter()" />
								</p:inputText>
							</f:facet>
							<h:outputText value="#{client.street == null ? label.not_registered : client.street}" />
						</p:column>

						<p:column 
							headerText="#{label.neighborhood}"
							filterBy="#{client.neighborhood}">
							
							<f:facet name="filter">
								<p:inputText>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableProducts').filter()" />
								</p:inputText>
							</f:facet>
							<h:outputText value="#{client.neighborhood == null ? label.not_registered : client.neighborhood}" />
						</p:column>
					
						<p:column 
							headerText="#{label.complement}"
							filterBy="#{client.complement}">
							
							<f:facet name="filter">
								<p:inputText>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableProducts').filter()" />
								</p:inputText>
							</f:facet>
							<h:outputText value="#{client.complement == null ? label.not_registered : client.complement}" />
						</p:column>
						
						<p:column 
							headerText="#{label.house_number}"
							filterBy="#{client.house_number}">
							
							<f:facet name="filter">
								<p:inputNumber>
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableProducts').filter()" />
								</p:inputNumber>
							</f:facet>
							<h:outputText value="#{client.house_number == null ? label.not_registered : client.house_number}" />
						</p:column>
						
						<p:column 
							headerText="#{label.last_login}"
							filterBy="#{client.lastLogin}">
							
							<f:facet name="filter">
								<p:datePicker pattern="dd/MM/yyyy">
									<p:ajax 
										event="valueChange" 
										oncomplete="PF('tableCustomers').filter()" />
									
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableCustomers').filter()" />									
								</p:datePicker>
							</f:facet>
							
							<h:outputText value="#{client.lastLogin.time}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</p:column>
						
						<p:column 
							headerText="#{label.last_changes}"
							filterBy="#{client.accountChangeDate}">
							
							<f:facet name="filter">
								<p:datePicker pattern="dd/MM/yyyy HH:mm">
									<p:ajax 
										event="valueChange" 
										oncomplete="PF('tableCustomers').filter()" />
									
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableCustomers').filter()" />									
								</p:datePicker>
							</f:facet>
							
							<h:outputText value="#{client.accountChangeDate}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</p:column>
						
						<p:column 
							headerText="#{label.registration_date}"
							filterBy="#{client.accountCreationDate}">
							
							<f:facet name="filter">
								<p:datePicker pattern="dd/MM/yyyy">
									<p:ajax 
										event="valueChange" 
										oncomplete="PF('tableCustomers').filter()" />
									
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableCustomers').filter()" />									
								</p:datePicker>
							</f:facet>
							
							<h:outputText value="#{client.accountCreationDate}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</p:column>

						<p:column 
							headerText="#{label.inactivation_date}"
							filterBy="#{client.inactivationDate}">
							
							<f:facet name="filter">
								<p:datePicker pattern="dd/MM/yyyy">
									<p:ajax 
										event="valueChange" 
										oncomplete="PF('tableCustomers').filter()" />
									
									<p:ajax 
										delay="500"
										event="keyup" 
										oncomplete="PF('tableCustomers').filter()" />									
								</p:datePicker>
							</f:facet>
							
							<h:outputText value="#{client.inactivationDate == null ? label.not_registered : client.inactivationDate}">
								<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
							</h:outputText>
						</p:column>						
					</p:dataTable>
				</h:form>
			
				<ui:include src="dialog-new-client.xhtml" />
				<ui:include src="dialog-change-client.xhtml" />
			</ui:define>
		</ui:composition>
	</h:body>
</html>