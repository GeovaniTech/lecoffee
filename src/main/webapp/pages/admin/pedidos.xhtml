<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
	lang="#{MBAppConfigs.appConfigs.language}"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:components="http://java.sun.com/jsf/composite/components"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
	
	<h:body>	
		<ui:composition template="/templates/admin/layout.xhtml">
			<ui:define name="name_page">
				<h:outputText value="#{label.orders}" />
			</ui:define>
			
			<ui:define name="body">
				<style>
					#menu-pedidos {
						background-color: var(--background-general-mouse);
						color: var(--text-mouse);
					}
					
					#menu-pedidos > * {
						color: var(--text-mouse);
					}
					
					.style {
						padding: 5px 10px;
						border-radius: 30px;
					  	display: inline-block;
					 	width: auto;
					 	font-size: 14px;
					 	color: black;
					}
					
					.container-orders {
						position: fixed;
						height: 100%;
						top: 66px;
						max-width: 400px;
						overflow-y: auto;
						padding-bottom: 65px;
					}
					
					.cardOrder {
						margin-left: 0px;
					}
				</style>
				
				<h:outputStylesheet library="css" name="/simpleCard/simpleCard.css" />
				<h:outputStylesheet library="css" name="/cardOrder/cardOrder.css" />
				
				<h:form id="formOrders">
					<p:poll 
						interval="10"
						update="@form"
						oncomplete="updateCards();"/>
					
					<p:remoteCommand 
						name="updateOrdersAdmin"
						update="@form" />
					
					<div class="container-orders">
						<ui:repeat var="order" value="#{MBListOrders.allOrdersAdmin}">
							<components:order 
								orderId="#{order.id}"
								clientName="#{order.client.nome}"
								clientEmail="#{order.client.email}"
								street="#{order.address.street}"
								house_number="#{order.address.house_number}"
								neighborhood="#{order.address.neighborhood}"
								cartId="#{order.cart.id}"
								requestDate="#{order.creationDate}"
								status="#{order.status}"
								paymentName="#{order.payment.name}"
								paymentIcon="#{order.payment.icon}"
								items="#{order.cart.items}"
								renderAdminOptions="true" />
						</ui:repeat>
					</div>
				</h:form>
				
				<h:form id="formCardInsights" style="margin-left: 400px;">
					<p:remoteCommand 
						name="updateCards"
						update="@form"/>
				
					<div class="horizontal-evenly">
						<components:simpleCard 
							title="A Confirmar"
							value="#{MBClientOrder.totalAConfirmar}"
							primefacesIcon="pi pi-clock" />
					
						<components:simpleCard 
							title="Em Preparo"
							value="#{MBClientOrder.totalEmPreparo}"
							primefacesIcon="pi pi-spinner" />
						
						<components:simpleCard 
							title="Enviado"
							value="#{MBClientOrder.totalEnviado}"
							primefacesIcon="pi pi-send" />
							
						<components:simpleCard 
							title="Finalizado"
							value="#{MBClientOrder.totalFinalizado}"
							primefacesIcon="pi pi-check-circle" />
						
						<components:simpleCard 
							title="Cancelado"
							value="#{MBClientOrder.totalCancelado}"
							primefacesIcon="pi pi-times-circle" />
					</div>
				</h:form>
				
				<h:form style="margin-left: 440px;" styleClass="vertical-left">
					<div class="order-top-buttons">
						<p:commandButton 
							icon="pi pi-plus"
							value="#{label.new_order}" 
							styleClass="mg-r-5" />
						
						<p:commandButton 
							icon="pi pi-times"
							value="#{label.cancel_changes}"
							styleClass="deleteStyle"
							disabled="true" />
					</div>
					
					<div class="horizontal-left mg-t-10">
						<div class="vertical-left">
							<components:lov 
								mBean="#{MBClientOrder}"
								objectLov="#{MBClientOrder.lovClient}"
								onRowSelect="#{MBClientOrder.onRowSelect()}"
								idField="lovClient"
								valueLabel="#{label.client}"
								toValue="#{MBClientOrder.lovClient.clientSelected}"
								valueInput="#{MBClientOrder.lovClient.clientSelected.email}" />
						</div>
					</div>
				</h:form>
			</ui:define>
		</ui:composition>
	</h:body>
</html>